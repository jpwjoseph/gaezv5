# gaezv5 Package Summary

## Overview

The `gaezv5` package provides tools for downloading and working with Global Agro-Ecological Zones (GAEZ) version 5 data from the Food and Agriculture Organization (FAO) and the International Institute for Applied Systems Analysis (IIASA). GAEZ v5 provides comprehensive global data on agricultural potential, crop suitability, attainable yields, and agro-climatic resources.

## Package Structure

```
gaezv5/
├── DESCRIPTION              # Package metadata and dependencies
├── NAMESPACE               # Exported functions and imports
├── LICENSE                 # GPL-3 license
├── README.md               # Package overview and quick start
├── NEWS.md                 # Version history and changelog
├── .Rbuildignore          # Files to exclude from build
├── .gitignore             # Git ignore patterns
│
├── R/                      # R source code
│   ├── data.R             # Data object documentation
│   ├── download.R         # Download functions
│   ├── file_management.R  # File utilities
│   ├── gaezv5-package.R   # Package-level documentation
│   ├── lookup.R           # Lookup functions
│   ├── url_builder.R      # URL construction
│   ├── utilities.R        # Helper functions
│   └── validation.R       # Validation functions
│
├── data/                   # Package data (.rda files)
│   ├── gaez_crops.rda     # Crop codes across themes 3-6
│   ├── gaez_scenarios.rda # Scenario definitions
│   ├── gaez_url_structure.rda  # URL patterns
│   └── gaez_variables.rda # Variable definitions
│
├── data-raw/               # Data preparation scripts
│   └── prepare_data.R     # Script to generate .rda files
│
├── tests/                  # Test framework
│   ├── testthat.R         # Test configuration
│   └── testthat/          # Test files
│
├── vignettes/              # Package vignettes
│   └── getting-started.Rmd    # Comprehensive tutorial
│
├── man/                    # Auto-generated documentation
│   └── (generated by roxygen2)
│
└── inst/                   # Additional package files
    └── extdata/           # Example data (if needed)
```

## Core Functions

### Data Discovery
1. `lookup_gaez_variable()` - Find variable codes by name or code with fuzzy matching
2. `lookup_gaez_crop()` - Find crop codes across different GAEZ themes
3. `list_gaez_crops()` - List all available crops with optional filtering by theme or crop group

### Data Download
4. `download_gaez_dataset()` - Download a single GAEZ dataset with comprehensive error handling
5. `batch_download_gaez_datasets()` - Download multiple datasets efficiently
6. `build_gaez_url()` - Construct GAEZ v5 download URLs

### File Management
7. `list_downloaded_files()` - Inventory of local GAEZ files
8. `check_url_exists()` - Validate URLs before download
9. `verify_file_integrity()` - Check downloaded file validity
10. `get_download_cache()` - Get cache directory
11. `clear_download_cache()` - Remove downloaded files

### Validation and Utilities
12. `validate_climate_ssp()` - Validate climate model and SSP combinations
13. `show_gaez_examples()` - Display usage examples

**Total: 13 exported functions**

## Data Objects

1. **gaez_variables** - Complete table of GAEZ v5 variables with codes, names, themes, and requirements
2. **gaez_crops** - Crop codes for themes 3-6 with names and crop groups
3. **gaez_scenarios** - Time periods, climate models, SSP scenarios, and water management codes
4. **gaez_url_structure** - URL construction patterns for different variable types

## Key Features

### Smart Data Access
- Intuitive lookup functions with fuzzy matching for easy code discovery
- Automatic parameter validation to ensure valid combinations
- Built-in caching to avoid re-downloading existing files
- Comprehensive error handling with informative messages

### Batch Processing
- Download multiple crops, scenarios, or time periods in one call
- Progress reporting for long-running downloads
- Automatic retry logic for network failures

### File Management
- Organized local file storage with clear naming conventions
- Tools to inventory, verify, and manage downloaded files
- Cache management to control disk usage

## Documentation

### Function Documentation
- All 13 functions have comprehensive roxygen2 documentation
- Each includes examples, parameter descriptions, and return value details
- Cross-references between related functions

### Data Documentation
- All 4 data objects are fully documented
- Includes format specifications, data sources, and usage examples

### Vignettes
- **getting-started**: Comprehensive tutorial covering basic workflow, common use cases, and GAEZ code reference

### Supporting Files
- **README.md**: Package overview, installation instructions, and quick start guide
- **NEWS.md**: Version history and feature changelog
- **LICENSE**: GPL-3 license

## Testing

- Comprehensive test suite using testthat framework
- Unit tests covering lookup functions, validation, utilities, and data integrity
- All tests pass with no errors or warnings

## Dependencies

### Imports
- dplyr (>= 1.0.0) - Data manipulation
- httr (>= 1.4.0) - HTTP requests
- stringr (>= 1.4.0) - String operations
- tibble (>= 3.0.0) - Modern data frames
- tidyr (>= 1.0.0) - Data tidying
- purrr (>= 0.3.0) - Functional programming
- tools (base R) - File utilities

### Suggests
- terra (>= 1.5.0) - Raster data handling
- testthat (>= 3.0.0) - Unit testing
- knitr, rmarkdown - Vignette building
- ggplot2, sf - Advanced spatial analysis

## GAEZ v5 Coverage

### Themes
1. Land and Water Resources - Terrain, soils, land cover
2. Agro-climatic Resources - Temperature, precipitation, growing periods
3. Agro-climatic Potential Yield - Climate-constrained yield potential
4. Suitability and Attainable Yield - Soil-climate yield potential
5. Actual Yields and Production - Observed yields and production
6. Yield and Production Gaps - Difference between potential and actual

### Temporal Coverage
- Historical periods: 1981-2000, 2001-2020
- Future projections: 2021-2040, 2041-2060, 2061-2080, 2081-2100

### Climate Scenarios
- Historical: AGERA5 reanalysis
- Future: Multiple GCMs and SSP scenarios (SSP126, SSP370, SSP585)

### Crop Coverage
- Over 60 crop types across cereals, roots/tubers, oil crops, pulses, sugar crops, and vegetables
- Both high and low input levels
- Irrigated and rain-fed systems

## Package Metadata

- **Package Name**: gaezv5
- **Version**: 0.1.0
- **License**: GPL (>= 3)
- **Author**: Julian Joseph (IIASA)
- **Maintainer**: Julian Joseph <joseph@iiasa.ac.at>
- **ORCID**: 0000-0002-3844-7807
- **URL**: https://github.com/jpwjoseph/gaezv5
- **BugReports**: https://github.com/jpwjoseph/gaezv5/issues

## Installation

### From GitHub
```r
# install.packages("devtools")
devtools::install_github("jpwjoseph/gaezv5")
```

### Local Installation
```r
# From source tarball
install.packages("gaezv5_0.1.0.tar.gz", repos = NULL, type = "source")

# Using devtools in package directory
devtools::install()
```

## Quick Start Example

```r
library(gaezv5)

# Browse available crops
crops <- list_gaez_crops(theme = 4)

# Download maize yield data for historical period
result <- download_gaez_dataset(
  crop = "maize",
  time_period = "HP0120",
  climate_model = "AGERA5"
)

# Load and visualize
library(terra)
r <- rast(result$file_path)
plot(r, main = "Maize Attainable Yield (2001-2020)")
```

## Data Sources

All data is sourced from:
- **GAEZ v5 Portal**: https://gaez.fao.org/
- **Model Documentation**: https://github.com/un-fao/gaezv5/wiki
- **Google Cloud Storage**: https://storage.googleapis.com/fao-gismgr-gaez-v5-data/

## Citation

When using GAEZ v5 data, please cite:

> FAO & IIASA. 2025. Global Agro-ecological Zoning version 5 (GAEZ v5) Model Documentation. https://github.com/un-fao/gaezv5/wiki

For this R package:
```r
citation("gaezv5")
```

## Acknowledgments

- FAO and IIASA for creating and maintaining GAEZ v5
- R Core Team and tidyverse developers

---

**Package Status**: Ready for distribution and use
**Version**: 0.1.0 (Initial Release)
